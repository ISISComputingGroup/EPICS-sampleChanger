record(stringout, "$(P)RECALC") {
	field(DTYP,"asynOctetWrite")
	field(OUT,"@asyn($(LOOKUP),0,0)RECALC")
	field(DESC, "Update the sample positions")
	field(FLNK, "$(P)_FORWARD")
}

record(calcout, "$(P)_FORWARD") {
	field(DESC, "Tell the lookup to reload")
	field(INPA, "$(TARGET_PV1)")
	field(CALC, "A+1")
	field(OUT, "$(TARGET_PV1) PP")
}

record(stringout, "$(P)SLOT:SP") {
	field(DTYP,"asynOctetWrite")
	field(OUT,"@asyn($(LOOKUP),0,0)SET_SLOT")
	field(DESC, "Set the slot which is in use")
    field(FLNK, "$(P)AVAILABLE_IN_SLOT")
    info(autosaveFields, "VAL")
    field(PINI, "YES")
}

record(stringin, "$(P)SLOT") {
	field(DTYP, "asynOctetRead")
    field(SCAN, ".1 second")
	field(INP, "@asyn($(LOOKUP),0,0)GET_SLOT")
	field(DESC, "Get the slot which is in use")
}

alias("$(P)SLOT", "$(P)SLOT:SP:RBV")

record(waveform, "$(P)AVAILABLE_SLOTS") {
	field(DTYP,"asynOctetRead")
	field(FTVL,"CHAR")
	field(NELM,"8000")
	field(INP,"@asyn($(LOOKUP),0,0)AVAILABLE_SLOTS")
	field(SCAN, "1 second")
}

record(waveform, "$(P)AVAILABLE_IN_SLOT") {
	field(DTYP,"asynOctetRead")
	field(FTVL,"CHAR")
	field(NELM,"8000")
	field(INP,"@asyn($(LOOKUP),0,0)AVAILABLE_IN_SLOT")
	field(FLNK,"$(P)RECALC")
}

